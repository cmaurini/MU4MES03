
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>From beams to frames &#8212; MU4MES03 - Slender structures - beams</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="An Introductory Example" href="../python_by_example.html" />
    <link rel="prev" title="Setting up Your Python Environment" href="../getting_started.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo-SU.jpeg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MU4MES03 - Slender structures - beams</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../about_py.html">
   Linear beams
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../getting_started.html">
     Setting up Your Python Environment
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     From beams to frames
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../python_by_example.html">
   An Introductory Example
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../learn_more.html">
   Learn More
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/quantecon-mini-example/master?urlpath=tree/mini_book/chapters/01/Beam.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/chapters/01/Beam.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#elemental-beam-problem">
   Elemental beam problem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extension">
     Extension
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bending">
     Bending
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#potential-energy-and-elemental-stiffness-matrix">
     Potential energy and elemental stiffness matrix
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#global-frame-and-change-of-coordinate">
   Global frame and change of coordinate
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#frame-assembling-several-beams">
   Frame: assembling several beams
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-nodes-and-geometry">
     Define nodes and geometry
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduce-global-vector-and-mapping-to-local-vectors">
     Introduce global vector and mapping to local vectors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#assembling-the-stiffness-matrix">
     Assembling the stiffness matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#apply-bcs-and-loads">
     Apply BCs and loads
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solve-the-linear-system">
     Solve the linear system
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-the-results">
     Visualize the results
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verification">
     Verification
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercice">
   Exercice
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>From beams to frames</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#elemental-beam-problem">
   Elemental beam problem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extension">
     Extension
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bending">
     Bending
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#potential-energy-and-elemental-stiffness-matrix">
     Potential energy and elemental stiffness matrix
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#global-frame-and-change-of-coordinate">
   Global frame and change of coordinate
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#frame-assembling-several-beams">
   Frame: assembling several beams
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-nodes-and-geometry">
     Define nodes and geometry
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduce-global-vector-and-mapping-to-local-vectors">
     Introduce global vector and mapping to local vectors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#assembling-the-stiffness-matrix">
     Assembling the stiffness matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#apply-bcs-and-loads">
     Apply BCs and loads
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solve-the-linear-system">
     Solve the linear system
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-the-results">
     Visualize the results
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verification">
     Verification
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercice">
   Exercice
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="from-beams-to-frames">
<h1>From beams to frames<a class="headerlink" href="#from-beams-to-frames" title="Permalink to this headline">#</a></h1>
<p>This notebooks introduce a simple method for frame modelling.
Objectives:</p>
<ul class="simple">
<li><p>Solve the linear beam differential equations using sympy</p></li>
<li></li>
</ul>
<p>Import statements : we use sympy and matplotlib</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="p">(</span><span class="n">Function</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">Derivative</span><span class="p">,</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">Array</span><span class="p">,</span> <span class="n">latex</span><span class="p">,</span>
                   <span class="n">dsolve</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">collect</span><span class="p">,</span> <span class="n">tensorcontraction</span><span class="p">,</span><span class="n">tensorproduct</span><span class="p">,</span> <span class="n">derive_by_array</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<section id="elemental-beam-problem">
<h2>Elemental beam problem<a class="headerlink" href="#elemental-beam-problem" title="Permalink to this headline">#</a></h2>
<p>We start by solving the elemental beam problem. It consists of a clamped-clamped straight beam where we apply the displacement and rotations at the two ends.
We denote by <span class="math notranslate nohighlight">\(\underline t\)</span> and <span class="math notranslate nohighlight">\(\underline n\)</span> the beam tangent and normal director, <span class="math notranslate nohighlight">\(L\)</span> the beam length, <span class="math notranslate nohighlight">\(EI\)</span> and <span class="math notranslate nohighlight">\(ES\)</span> the bending and extensional stiffness. We assume an unsherable extensible Navier-Bernoulli model and that the beam. We decompose the displacement and rotation as follows:
$<span class="math notranslate nohighlight">\(
\underline{u}(s)=u(s)\underline t+v(s)\underline n,\qquad 
\underline{\theta}(s)=\theta(s)\,\underline b,\qquad\underline {b}:=\underline t\times\underline n
\)</span>$
We introduce below the notation and the expression of the potential energy using <code class="docutils literal notranslate"><span class="pre">sympy</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;s L&quot;</span><span class="p">)</span>
<span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s2">&quot;u&quot;</span><span class="p">),</span> <span class="n">Function</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">)</span>
<span class="n">EI</span><span class="p">,</span> <span class="n">EA</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;EI , ES&quot;</span><span class="p">)</span>
<span class="n">bending_energy</span> <span class="o">=</span> <span class="n">EI</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">integrate</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">))</span>
<span class="n">extensional_energy</span> <span class="o">=</span> <span class="n">EA</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">integrate</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">))</span>
<span class="n">elastic_energy</span> <span class="o">=</span> <span class="n">bending_energy</span> <span class="o">+</span> <span class="n">extensional_energy</span>
<span class="n">total_energy</span> <span class="o">=</span> <span class="n">elastic_energy</span> <span class="c1"># there are not external forces only applied displacements</span>
<span class="n">total_energy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{EI \int\limits_{0}^{L} \left(\frac{d^{2}}{d s^{2}} v{\left(s \right)}\right)^{2}\, ds}{2} + \frac{ES \int\limits_{0}^{L} \left(\frac{d}{d s} u{\left(s \right)}\right)^{2}\, ds}{2}\]</div>
</div>
</div>
<p>In the absence of distributed loading the governing equations are as follows (they can by found by imposing the stationarity of the potential energy)</p>
<ul class="simple">
<li><p>Extension
$<span class="math notranslate nohighlight">\(
u''(s)=0\quad\forall  s\in(0,L),\qquad u(0)=u_0,\qquad u(L)=u_L
\)</span>$</p></li>
<li><p>Bending
$<span class="math notranslate nohighlight">\(
v''''(s)=0\quad\forall  s\in(0,L),\qquad v(0)=v_0,\;v'(0)=\theta_0,\; v(L)=v_L,\; v'(L)=\theta_L
\)</span>$</p></li>
</ul>
<section id="extension">
<h3>Extension<a class="headerlink" href="#extension" title="Permalink to this headline">#</a></h3>
<p>We solve below the extensional problem using <code class="docutils literal notranslate"><span class="pre">sympy</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;s L&quot;</span><span class="p">)</span>
<span class="n">u0</span><span class="p">,</span> <span class="n">uL</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;u_0 u_L&quot;</span><span class="p">)</span>
<span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">Derivative</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="p">),</span><span class="mi">0</span><span class="p">))</span>
<span class="n">usol</span> <span class="o">=</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">{</span><span class="n">u</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span><span class="n">u0</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">L</span><span class="p">):</span><span class="n">uL</span><span class="p">})</span>
<span class="n">usol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle u{\left(s \right)} = u_{0} + \frac{s \left(- u_{0} + u_{L}\right)}{L}\]</div>
</div>
</div>
</section>
<section id="bending">
<h3>Bending<a class="headerlink" href="#bending" title="Permalink to this headline">#</a></h3>
<p>… and similarly for the bending problem</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v0</span><span class="p">,</span> <span class="n">vL</span><span class="p">,</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">thetaL</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;v_0 v_L </span><span class="se">\\</span><span class="s2">theta_0 </span><span class="se">\\</span><span class="s2">theta_L&quot;</span><span class="p">)</span>
<span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="mi">0</span><span class="p">))</span>
<span class="n">vsol</span> <span class="o">=</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">{</span><span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="n">v0</span><span class="p">,</span> 
               <span class="n">v</span><span class="p">(</span><span class="n">L</span><span class="p">):</span> <span class="n">vL</span><span class="p">,</span>
               <span class="n">v</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="n">theta0</span><span class="p">,</span>
               <span class="n">v</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span> <span class="n">thetaL</span><span class="p">})</span>
<span class="n">vsol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle v{\left(s \right)} = \theta_{0} s + v_{0} + \frac{s^{2} \left(- 2 L \theta_{0} - L \theta_{L} - 3 v_{0} + 3 v_{L}\right)}{L^{2}} + \frac{s^{3} \left(L \theta_{0} + L \theta_{L} + 2 v_{0} - 2 v_{L}\right)}{L^{3}}\]</div>
</div>
</div>
</section>
<section id="potential-energy-and-elemental-stiffness-matrix">
<h3>Potential energy and elemental stiffness matrix<a class="headerlink" href="#potential-energy-and-elemental-stiffness-matrix" title="Permalink to this headline">#</a></h3>
<p>Hence, we can compute the potential energy of the system in terms of the imposed end-displacement and end-rotation in terms of an elemental stiffness matrix <span class="math notranslate nohighlight">\(\underline{\underline{K}}\)</span> as
$<span class="math notranslate nohighlight">\(
E_p(\underline U)=\dfrac{1}{2}(\underline{\underline K}.\underline{U}).\underline{U}
\)</span><span class="math notranslate nohighlight">\(
where \)</span>\underline{U}$ is the vector collecting the imposed displacement and rotation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ue</span> <span class="o">=</span> <span class="n">Array</span><span class="p">((</span><span class="n">u0</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="n">theta0</span><span class="p">,</span><span class="n">uL</span><span class="p">,</span><span class="n">vL</span><span class="p">,</span><span class="n">thetaL</span><span class="p">))</span>
<span class="n">Ue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left[\begin{matrix}u_{0} &amp; v_{0} &amp; \theta_{0} &amp; u_{L} &amp; v_{L} &amp; \theta_{L}\end{matrix}\right]\]</div>
</div>
</div>
<p>The solution can be written in the form
$<span class="math notranslate nohighlight">\(
\begin{bmatrix}
u(s)\\v(s)
\end{bmatrix}
=\underline{\underline{D}}.\underline U_e
\)</span>$
where</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">usol</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Ui</span><span class="p">)</span> <span class="k">for</span> <span class="n">Ui</span> <span class="ow">in</span> <span class="n">Ue</span><span class="p">],</span>
     <span class="p">[</span><span class="n">vsol</span><span class="o">.</span><span class="n">rhs</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Ui</span><span class="p">)</span> <span class="k">for</span> <span class="n">Ui</span> <span class="ow">in</span> <span class="n">Ue</span><span class="p">]])</span>
<span class="n">D</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}1 - \frac{s}{L} &amp; 0 &amp; 0 &amp; \frac{s}{L} &amp; 0 &amp; 0\\0 &amp; 1 - \frac{3 s^{2}}{L^{2}} + \frac{2 s^{3}}{L^{3}} &amp; s - \frac{2 s^{2}}{L} + \frac{s^{3}}{L^{2}} &amp; 0 &amp; \frac{3 s^{2}}{L^{2}} - \frac{2 s^{3}}{L^{3}} &amp; - \frac{s^{2}}{L} + \frac{s^{3}}{L^{2}}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>The total energy of the solution is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_energy_sol</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">total_energy</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">u</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="n">usol</span><span class="o">.</span><span class="n">rhs</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="n">vsol</span><span class="o">.</span><span class="n">rhs</span><span class="p">}))</span>
<span class="n">total_energy_sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{\frac{4 EI \left(L^{3} \cdot \left(3 L^{2} \theta_{0}^{2} + 6 L^{2} \theta_{0} \theta_{L} + 3 L^{2} \theta_{L}^{2} + 12 L \theta_{0} v_{0} - 12 L \theta_{0} v_{L} + 12 L \theta_{L} v_{0} - 12 L \theta_{L} v_{L} + 12 v_{0}^{2} - 24 v_{0} v_{L} + 12 v_{L}^{2}\right) + L^{2} \left(- 6 L^{3} \theta_{0}^{2} - 9 L^{3} \theta_{0} \theta_{L} - 3 L^{3} \theta_{L}^{2} - 21 L^{2} \theta_{0} v_{0} + 21 L^{2} \theta_{0} v_{L} - 15 L^{2} \theta_{L} v_{0} + 15 L^{2} \theta_{L} v_{L} - 18 L v_{0}^{2} + 36 L v_{0} v_{L} - 18 L v_{L}^{2}\right) + L \left(4 L^{4} \theta_{0}^{2} + 4 L^{4} \theta_{0} \theta_{L} + L^{4} \theta_{L}^{2} + 12 L^{3} \theta_{0} v_{0} - 12 L^{3} \theta_{0} v_{L} + 6 L^{3} \theta_{L} v_{0} - 6 L^{3} \theta_{L} v_{L} + 9 L^{2} v_{0}^{2} - 18 L^{2} v_{0} v_{L} + 9 L^{2} v_{L}^{2}\right)\right)}{L^{4}} + ES L \left(- u_{0} + u_{L}\right)^{2}}{2 L^{2}}\]</div>
</div>
</div>
<p>And the elemental stiffness matrix is given by</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ke</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">total_energy_sol</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Ui</span><span class="p">,</span><span class="n">Uj</span><span class="p">)</span> <span class="k">for</span> <span class="n">Ui</span> <span class="ow">in</span> <span class="n">Ue</span><span class="p">]</span> <span class="k">for</span> <span class="n">Uj</span> <span class="ow">in</span> <span class="n">Ue</span><span class="p">])</span>
<span class="n">Ke</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\frac{ES}{L} &amp; 0 &amp; 0 &amp; - \frac{ES}{L} &amp; 0 &amp; 0\\0 &amp; \frac{12 EI}{L^{3}} &amp; \frac{6 EI}{L^{2}} &amp; 0 &amp; - \frac{12 EI}{L^{3}} &amp; \frac{6 EI}{L^{2}}\\0 &amp; \frac{6 EI}{L^{2}} &amp; \frac{4 EI}{L} &amp; 0 &amp; - \frac{6 EI}{L^{2}} &amp; \frac{2 EI}{L}\\- \frac{ES}{L} &amp; 0 &amp; 0 &amp; \frac{ES}{L} &amp; 0 &amp; 0\\0 &amp; - \frac{12 EI}{L^{3}} &amp; - \frac{6 EI}{L^{2}} &amp; 0 &amp; \frac{12 EI}{L^{3}} &amp; - \frac{6 EI}{L^{2}}\\0 &amp; \frac{6 EI}{L^{2}} &amp; \frac{2 EI}{L} &amp; 0 &amp; - \frac{6 EI}{L^{2}} &amp; \frac{4 EI}{L}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
</section>
</section>
<section id="global-frame-and-change-of-coordinate">
<h2>Global frame and change of coordinate<a class="headerlink" href="#global-frame-and-change-of-coordinate" title="Permalink to this headline">#</a></h2>
<p>Let us known introduce a global frame <span class="math notranslate nohighlight">\((0,\underline{e_1},\underline{e_2})\)</span> and let us call <span class="math notranslate nohighlight">\(\alpha\)</span> the angle giving the orientation of the tangent  and normal vector in this frame. We can then define the coordinates of the displacement vector <span class="math notranslate nohighlight">\(\underline u\)</span> in this new frame</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">alpha&quot;</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Array</span><span class="p">([</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)])</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">Array</span><span class="p">([</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)])</span>
<span class="n">u_star</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">v</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span>
<span class="n">u_star</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left[\begin{matrix}u{\left(s \right)} \cos{\left(\alpha \right)} - v{\left(s \right)} \sin{\left(\alpha \right)} &amp; u{\left(s \right)} \sin{\left(\alpha \right)} + v{\left(s \right)} \cos{\left(\alpha \right)}\end{matrix}\right]\]</div>
</div>
</div>
<p>We define <span class="math notranslate nohighlight">\(\underline{U}^*_{e}\)</span> the vector giving the component of the end-displacement
<span class="math notranslate nohighlight">\(\underline{U}_e\)</span> in the global frame.
Hence, we compute the following orthogonal matrix <span class="math notranslate nohighlight">\(T\)</span> such that
$<span class="math notranslate nohighlight">\(\underline{U}^*_e = T.\underline{U}_e,\qquad
\underline{U}_e = T^t.\underline{U}^*_e\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u0_s</span> <span class="o">=</span> <span class="n">u0</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">v0</span> <span class="o">*</span> <span class="n">n</span>
<span class="n">uL_s</span> <span class="o">=</span> <span class="n">uL</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">vL</span> <span class="o">*</span> <span class="n">n</span>
<span class="n">Ue_s</span> <span class="o">=</span> <span class="n">Array</span><span class="p">((</span><span class="n">u0_s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">u0_s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">theta0</span><span class="p">,</span><span class="n">uL_s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">uL_s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">thetaL</span><span class="p">))</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">Ue_s</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Ui</span><span class="p">)</span> <span class="k">for</span> <span class="n">Ui</span> <span class="ow">in</span> <span class="n">Ue</span><span class="p">])</span>
<span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\cos{\left(\alpha \right)} &amp; \sin{\left(\alpha \right)} &amp; 0 &amp; 0 &amp; 0 &amp; 0\\- \sin{\left(\alpha \right)} &amp; \cos{\left(\alpha \right)} &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; \cos{\left(\alpha \right)} &amp; \sin{\left(\alpha \right)} &amp; 0\\0 &amp; 0 &amp; 0 &amp; - \sin{\left(\alpha \right)} &amp; \cos{\left(\alpha \right)} &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>The local stiffness matrix in the new coordinate is defined by</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ke_s</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">Ke</span><span class="p">)</span><span class="o">*</span><span class="n">T</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">Ke_s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\frac{12 EI \sin^{2}{\left(\alpha \right)}}{L^{3}} + \frac{ES \cos^{2}{\left(\alpha \right)}}{L} &amp; \frac{12 EI \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L^{3}} - \frac{ES \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L} &amp; \frac{6 EI \sin{\left(\alpha \right)}}{L^{2}} &amp; - \frac{12 EI \sin^{2}{\left(\alpha \right)}}{L^{3}} - \frac{ES \cos^{2}{\left(\alpha \right)}}{L} &amp; - \frac{12 EI \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L^{3}} + \frac{ES \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L} &amp; \frac{6 EI \sin{\left(\alpha \right)}}{L^{2}}\\\frac{12 EI \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L^{3}} - \frac{ES \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L} &amp; \frac{12 EI \cos^{2}{\left(\alpha \right)}}{L^{3}} + \frac{ES \sin^{2}{\left(\alpha \right)}}{L} &amp; \frac{6 EI \cos{\left(\alpha \right)}}{L^{2}} &amp; - \frac{12 EI \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L^{3}} + \frac{ES \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L} &amp; - \frac{12 EI \cos^{2}{\left(\alpha \right)}}{L^{3}} - \frac{ES \sin^{2}{\left(\alpha \right)}}{L} &amp; \frac{6 EI \cos{\left(\alpha \right)}}{L^{2}}\\\frac{6 EI \sin{\left(\alpha \right)}}{L^{2}} &amp; \frac{6 EI \cos{\left(\alpha \right)}}{L^{2}} &amp; \frac{4 EI}{L} &amp; - \frac{6 EI \sin{\left(\alpha \right)}}{L^{2}} &amp; - \frac{6 EI \cos{\left(\alpha \right)}}{L^{2}} &amp; \frac{2 EI}{L}\\- \frac{12 EI \sin^{2}{\left(\alpha \right)}}{L^{3}} - \frac{ES \cos^{2}{\left(\alpha \right)}}{L} &amp; - \frac{12 EI \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L^{3}} + \frac{ES \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L} &amp; - \frac{6 EI \sin{\left(\alpha \right)}}{L^{2}} &amp; \frac{12 EI \sin^{2}{\left(\alpha \right)}}{L^{3}} + \frac{ES \cos^{2}{\left(\alpha \right)}}{L} &amp; \frac{12 EI \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L^{3}} - \frac{ES \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L} &amp; - \frac{6 EI \sin{\left(\alpha \right)}}{L^{2}}\\- \frac{12 EI \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L^{3}} + \frac{ES \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L} &amp; - \frac{12 EI \cos^{2}{\left(\alpha \right)}}{L^{3}} - \frac{ES \sin^{2}{\left(\alpha \right)}}{L} &amp; - \frac{6 EI \cos{\left(\alpha \right)}}{L^{2}} &amp; \frac{12 EI \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L^{3}} - \frac{ES \sin{\left(\alpha \right)} \cos{\left(\alpha \right)}}{L} &amp; \frac{12 EI \cos^{2}{\left(\alpha \right)}}{L^{3}} + \frac{ES \sin^{2}{\left(\alpha \right)}}{L} &amp; - \frac{6 EI \cos{\left(\alpha \right)}}{L^{2}}\\\frac{6 EI \sin{\left(\alpha \right)}}{L^{2}} &amp; \frac{6 EI \cos{\left(\alpha \right)}}{L^{2}} &amp; \frac{2 EI}{L} &amp; - \frac{6 EI \sin{\left(\alpha \right)}}{L^{2}} &amp; - \frac{6 EI \cos{\left(\alpha \right)}}{L^{2}} &amp; \frac{4 EI}{L}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
</section>
<section id="frame-assembling-several-beams">
<h2>Frame: assembling several beams<a class="headerlink" href="#frame-assembling-several-beams" title="Permalink to this headline">#</a></h2>
<section id="define-nodes-and-geometry">
<h3>Define nodes and geometry<a class="headerlink" href="#define-nodes-and-geometry" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>

<span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>

<span class="n">n_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
<span class="n">n_elements</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">dof_map</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the global dof number giving element and local dof number&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">e</span> <span class="o">+</span> <span class="n">i</span>

<span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="n">element_nodes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the element length&quot;&quot;&quot;</span>
    <span class="n">vec</span> <span class="o">=</span> <span class="n">element_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">element_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span><span class="n">vec</span><span class="p">))</span>
    
<span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="n">element_nodes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the element orientation&quot;&quot;&quot;</span>
    <span class="n">vec</span> <span class="o">=</span> <span class="n">element_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">element_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">Ls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">length</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">el</span><span class="p">])</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">])</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">angle</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="n">el</span><span class="p">])</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alphas</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ls</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.78539816 -0.78539816]
[1.41421356 1.41421356]
</pre></div>
</div>
</div>
</div>
</section>
<section id="introduce-global-vector-and-mapping-to-local-vectors">
<h3>Introduce global vector and mapping to local vectors<a class="headerlink" href="#introduce-global-vector-and-mapping-to-local-vectors" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">n_nodes</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">U_elem</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">e</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Returns the element local values in global coordinates&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">U</span><span class="p">[</span><span class="n">dof_map</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">i</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)])</span>

<span class="k">def</span> <span class="nf">U_elem_loc</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">e</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Returns the element local values in local coordinates&quot;&quot;&quot;</span>
    <span class="n">T_mat</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">alpha</span><span class="p">:</span><span class="n">alphas</span><span class="p">[</span><span class="n">e</span><span class="p">]})</span>
    <span class="k">return</span>  <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T_mat</span><span class="p">,</span> <span class="n">U_elem</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">e</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">U_node</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Returns the displacement of a node&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">U</span><span class="o">.</span><span class="n">take</span><span class="p">([</span><span class="mi">3</span> <span class="o">*</span> <span class="n">n</span> <span class="p">,</span><span class="mi">3</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="assembling-the-stiffness-matrix">
<h3>Assembling the stiffness matrix<a class="headerlink" href="#assembling-the-stiffness-matrix" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">EA_n</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">EI_n</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">EAs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">))</span>
<span class="n">EIs</span> <span class="o">=</span> <span class="n">EI_n</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">))</span>
<span class="n">K_global</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span> <span class="o">*</span> <span class="n">n_nodes</span><span class="p">,</span><span class="mi">3</span> <span class="o">*</span> <span class="n">n_nodes</span><span class="p">])</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">elements</span><span class="p">):</span>
    <span class="n">K_element</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ke_s</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;L&quot;</span> <span class="p">:</span> <span class="n">Ls</span><span class="p">[</span><span class="n">e</span><span class="p">],</span> 
                                    <span class="s2">&quot;ES&quot;</span> <span class="p">:</span> <span class="n">EAs</span><span class="p">[</span><span class="n">e</span><span class="p">],</span>
                                    <span class="s2">&quot;EI&quot;</span> <span class="p">:</span> <span class="n">EIs</span><span class="p">[</span><span class="n">e</span><span class="p">],</span>
                                    <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">alpha&quot;</span> <span class="p">:</span> <span class="n">alphas</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
                                    <span class="p">}),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">global_dofs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span> <span class="o">*</span> <span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span>  <span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">3</span> <span class="o">*</span>  <span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span>  <span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> 
    <span class="n">K_global</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">global_dofs</span><span class="p">,</span><span class="n">global_dofs</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">K_element</span> <span class="c1">#[i:i+3,i:i+3]</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">K_global</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x14a8c8dc0&gt;
</pre></div>
</div>
<img alt="../../_images/Beam_30_1.png" src="../../_images/Beam_30_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span><span class="p">(</span><span class="n">K_global</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}0.565685424949238 &amp; -0.14142135623731 &amp; 0.212132034355964 &amp; -0.565685424949238 &amp; 0.14142135623731 &amp; 0.212132034355964 &amp; 0 &amp; 0 &amp; 0\\-0.14142135623731 &amp; 0.565685424949238 &amp; 0.212132034355964 &amp; 0.14142135623731 &amp; -0.565685424949238 &amp; 0.212132034355964 &amp; 0 &amp; 0 &amp; 0\\0.212132034355964 &amp; 0.212132034355964 &amp; 0.282842712474619 &amp; -0.212132034355964 &amp; -0.212132034355964 &amp; 0.14142135623731 &amp; 0 &amp; 0 &amp; 0\\-0.565685424949238 &amp; 0.14142135623731 &amp; -0.212132034355964 &amp; 1.13137084989848 &amp; 0 &amp; -0.424264068711928 &amp; -0.565685424949238 &amp; -0.14142135623731 &amp; -0.212132034355964\\0.14142135623731 &amp; -0.565685424949238 &amp; -0.212132034355964 &amp; 0 &amp; 1.13137084989848 &amp; 0 &amp; -0.14142135623731 &amp; -0.565685424949238 &amp; 0.212132034355964\\0.212132034355964 &amp; 0.212132034355964 &amp; 0.14142135623731 &amp; -0.424264068711928 &amp; 0 &amp; 0.565685424949238 &amp; 0.212132034355964 &amp; -0.212132034355964 &amp; 0.14142135623731\\0 &amp; 0 &amp; 0 &amp; -0.565685424949238 &amp; -0.14142135623731 &amp; 0.212132034355964 &amp; 0.565685424949238 &amp; 0.14142135623731 &amp; 0.212132034355964\\0 &amp; 0 &amp; 0 &amp; -0.14142135623731 &amp; -0.565685424949238 &amp; -0.212132034355964 &amp; 0.14142135623731 &amp; 0.565685424949238 &amp; -0.212132034355964\\0 &amp; 0 &amp; 0 &amp; -0.212132034355964 &amp; 0.212132034355964 &amp; 0.14142135623731 &amp; 0.212132034355964 &amp; -0.212132034355964 &amp; 0.282842712474619\end{matrix}\right]\end{split}\]</div>
</div>
</div>
</section>
<section id="apply-bcs-and-loads">
<h3>Apply BCs and loads<a class="headerlink" href="#apply-bcs-and-loads" title="Permalink to this headline">#</a></h3>
<p>To apply the boundary condition we modify the linear system to solve (see the finite element class)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bc_apply</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">blocked_dof</span><span class="p">,</span><span class="n">bc_values</span><span class="p">):</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blocked_dof</span><span class="p">):</span> 
        <span class="n">Kbc</span> <span class="o">=</span> <span class="n">K</span> 
        <span class="n">Fbc</span> <span class="o">=</span> <span class="n">F</span>
        <span class="n">Kbc</span><span class="p">[</span><span class="n">dof</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Kbc</span><span class="p">[:,</span> <span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Kbc</span><span class="p">[</span><span class="n">dof</span><span class="p">,</span> <span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">Fbc</span> <span class="o">+=</span>  <span class="o">-</span> <span class="n">K</span><span class="p">[:,</span><span class="n">dof</span><span class="p">]</span><span class="o">*</span><span class="n">bc_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">Fbc</span><span class="p">[</span><span class="n">dof</span><span class="p">]</span> <span class="o">=</span> <span class="n">bc_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Kbc</span><span class="p">,</span> <span class="n">Fbc</span>
</pre></div>
</div>
</div>
</div>
<p>We select the blocked dofs, the apply force and define the final linear system to solve</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">blocked_dof</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="n">bc_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">blocked_dof</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">blocked_dof</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_nodes</span> <span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_nodes</span> <span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="n">F</span><span class="p">[</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">F</span><span class="p">[</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Kbc</span><span class="p">,</span> <span class="n">Fbc</span> <span class="o">=</span> <span class="n">bc_apply</span><span class="p">(</span><span class="n">K_global</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">blocked_dof</span><span class="p">,</span> <span class="n">bc_values</span><span class="p">)</span>
<span class="n">Matrix</span><span class="p">(</span><span class="n">Kbc</span><span class="p">),</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Fbc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0 1 6 7]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(Matrix([
 [1.0,   0,                  0,                  0,                  0,                  0,   0,   0,                  0],
 [  0, 1.0,                  0,                  0,                  0,                  0,   0,   0,                  0],
 [  0,   0,  0.282842712474619, -0.212132034355964, -0.212132034355964,   0.14142135623731,   0,   0,                  0],
 [  0,   0, -0.212132034355964,   1.13137084989848,                  0, -0.424264068711928,   0,   0, -0.212132034355964],
 [  0,   0, -0.212132034355964,                  0,   1.13137084989848,                  0,   0,   0,  0.212132034355964],
 [  0,   0,   0.14142135623731, -0.424264068711928,                  0,  0.565685424949238,   0,   0,   0.14142135623731],
 [  0,   0,                  0,                  0,                  0,                  0, 1.0,   0,                  0],
 [  0,   0,                  0,                  0,                  0,                  0,   0, 1.0,                  0],
 [  0,   0,                  0, -0.212132034355964,  0.212132034355964,   0.14142135623731,   0,   0,  0.282842712474619]]),
 Matrix([
 [  0],
 [  0],
 [  0],
 [1.0],
 [1.0],
 [  0],
 [  0],
 [  0],
 [  0]]))
</pre></div>
</div>
</div>
</div>
</section>
<section id="solve-the-linear-system">
<h3>Solve the linear system<a class="headerlink" href="#solve-the-linear-system" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Usol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Kbc</span><span class="p">,</span><span class="n">Fbc</span><span class="p">)</span>
<span class="n">Usol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.        ,  0.        ,  1.62941997,  1.41421356,  1.22975092,
        0.70710678,  0.        ,  0.        , -0.21520641])
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-the-results">
<h3>Visualize the results<a class="headerlink" href="#visualize-the-results" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">element_displacement</span><span class="p">(</span><span class="n">U_s</span><span class="p">,</span><span class="n">e</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">((</span><span class="n">Matrix</span><span class="p">([</span><span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">])</span> <span class="o">*</span> <span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">alpha</span><span class="p">:</span><span class="n">alphas</span><span class="p">[</span><span class="n">e</span><span class="p">],</span><span class="n">L</span><span class="p">:</span><span class="n">Ls</span><span class="p">[</span><span class="n">e</span><span class="p">]}),</span> <span class="n">U_elem_loc</span><span class="p">(</span><span class="n">U_s</span><span class="p">,</span><span class="n">e</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">element_initial</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">nodes</span><span class="p">[</span><span class="n">elements</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">s</span> <span class="o">*</span> <span class="n">t</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">alpha</span><span class="p">:</span><span class="n">alphas</span><span class="p">[</span><span class="n">e</span><span class="p">]})</span>

<span class="k">def</span> <span class="nf">element_deformed</span><span class="p">(</span><span class="n">U_s</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">factor</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">element_initial</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">+</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">element_displacement</span><span class="p">(</span><span class="n">U_s</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>


<span class="n">ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">elements</span><span class="p">):</span>
    <span class="n">fun</span> <span class="o">=</span> <span class="n">element_initial</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">fun</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">s</span><span class="p">:</span><span class="n">sv</span><span class="p">})</span> <span class="k">for</span> <span class="n">sv</span> <span class="ow">in</span> <span class="n">ss</span> <span class="o">*</span> <span class="n">Ls</span><span class="p">[</span><span class="n">e</span><span class="p">]],</span> <span class="p">[</span><span class="n">fun</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">s</span><span class="p">:</span><span class="n">sv</span><span class="p">})</span> <span class="k">for</span> <span class="n">sv</span> <span class="ow">in</span> <span class="n">ss</span> <span class="o">*</span> <span class="n">Ls</span><span class="p">[</span><span class="n">e</span><span class="p">]],</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">nodes</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;darkgray&quot;</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">elements</span><span class="p">):</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="mf">.5</span> 
    <span class="n">fun</span> <span class="o">=</span> <span class="n">element_deformed</span><span class="p">(</span><span class="n">Usol</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">factor</span><span class="o">=</span><span class="n">factor</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">fun</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">s</span><span class="p">:</span><span class="n">sv</span><span class="p">})</span> <span class="k">for</span> <span class="n">sv</span> <span class="ow">in</span> <span class="n">ss</span> <span class="o">*</span> <span class="n">Ls</span><span class="p">[</span><span class="n">e</span><span class="p">]],</span> <span class="p">[</span><span class="n">fun</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">s</span><span class="p">:</span><span class="n">sv</span><span class="p">})</span> <span class="k">for</span> <span class="n">sv</span> <span class="ow">in</span> <span class="n">ss</span> <span class="o">*</span> <span class="n">Ls</span><span class="p">[</span><span class="n">e</span><span class="p">]],</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">U_node</span><span class="p">(</span><span class="n">Usol</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
             <span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Reference and deformed configurations&quot;</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Beam_39_0.png" src="../../_images/Beam_39_0.png" />
</div>
</div>
</section>
<section id="verification">
<h3>Verification<a class="headerlink" href="#verification" title="Permalink to this headline">#</a></h3>
<p>The exact solution for the nodal displacement of the top node is (see Ballard, page 74)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_exact</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">Array</span><span class="p">([</span><span class="n">L</span><span class="o">/</span><span class="n">EA</span> <span class="p">,(</span><span class="mi">1</span><span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">EA</span> <span class="o">*</span> <span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">EI</span><span class="p">))</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">EA</span><span class="p">)]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">u_exact</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">L</span><span class="p">:</span><span class="n">Ls</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">EA</span><span class="p">:</span><span class="n">EA_n</span><span class="p">,</span><span class="n">EI</span><span class="p">:</span><span class="n">EI_n</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.4142135623731, 1.22975092380269]
</pre></div>
</div>
</div>
</div>
<p>The numerical solution is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U_node</span><span class="p">(</span><span class="n">Usol</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.41421356, 1.22975092])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="exercice">
<h2>Exercice<a class="headerlink" href="#exercice" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>Build you own frame structure with the Mola model.</p></li>
<li><p>Define the corresponding frame model by modifying this notebook</p></li>
<li><p>Choose a load case and perform a qualitative comparison of the structural deformed configuration:</p>
<ul class="simple">
<li><p>Take a photo of the deformed configuration of the real structure under the imposed load</p></li>
<li><p>Compare qualitatively with the deformed configuration plot obtained with your code</p></li>
</ul>
</li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/01"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../getting_started.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Setting up Your Python Environment</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../python_by_example.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">An Introductory Example</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Corrado Maurini<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>